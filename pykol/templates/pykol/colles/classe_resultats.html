{% extends "pykol/base.html" %}
{% load resultats %}
{% block head %}
{{ block.super }}
<link rel="alternate" href="?format=odf" type="application/vnd.oasis.opendocument.spreadsheet">
{% endblock %}
{% block content %}
<h2>Notes de colles
  <small>− {{ classe }}</small>
  <small><a title="Télécharger au format OpenDocument"
      href="?format=odf"><i class="fa fa-download"></i></a></small>
</h2>
{% for matiere, tableau_matiere in matieres.items %}
<section>
  <h3>Notes des étudiants en {{matiere}}</h3>
  <table class="resultats">
    <tr>
      <th>Étudiant</th>
      <th>Moyenne</th>
      <th>Rang</th>
      {% for semaine in semaines %}
      <th>{{ semaine.numero }}</th>
      {% endfor %}
      </tr>
      {% for etudiant, resultats in tableau_matiere.etudiants.items %}
      <tr>
        <td>{{ etudiant }}</td>
        <td>{{ resultats.moyenne|floatformat }}</td>
        <td>{{ resultats.rang|rang }}</td>
        {% for notes in resultats.notes %}
        <td>{{ notes|join:', ' }}</td>
        {% endfor %}
      </tr>
      {% endfor %}
  </table>
  {% if tableau_matiere.periode_form %}
  <h3>Périodes de notation</h3>
  <p>Vous pouvez découper l'année en plusieurs périodes de notation afin
  de calculer les moyennes de colles séparément sur chaque période.</p>
  <form method="post" action="{% url 'classe_periode_notation' classe.slug %}">
    {% csrf_token %}
    {{ tableau_matiere.periode_form.as_table }}
    <p><input type="submit" value="Enregistrer les périodes">
  </form>
  {% endif %}
</section>
{% empty %}
<section>
  <p>Vous n'intervenez dans aucune matière pour laquelle des colles ont
  lieu dans cette classe.</p>
</section>
{% endfor %}
{% endblock %}
